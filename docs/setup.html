<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üõ†Ô∏è AI Setup Wizard</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-900 text-white font-sans px-6 py-10">
  <div class="max-w-xl mx-auto">
    <h1 class="text-3xl font-bold mb-6 text-center">üõ†Ô∏è AI Setup Wizard</h1>

    <form id="setupForm" class="space-y-6">
      <div>
        <label class="block mb-1 text-sm">GitHub Client ID</label>
        <input type="text" id="clientID" class="w-full p-2 rounded text-black" placeholder="e.g., Iv1.abc123">
      </div>
      <div>
        <label class="block mb-1 text-sm">GitHub Token (PAT)</label>
        <input type="password" id="githubToken" class="w-full p-2 rounded text-black" placeholder="ghp_xxx">
      </div>
      <div>
        <label class="block mb-1 text-sm">OpenAI API Key</label>
        <input type="password" id="openaiKey" class="w-full p-2 rounded text-black" placeholder="sk-...">
      </div>
      <div class="text-center">
        <button type="button" onclick="runTestsAndSave()" class="bg-green-600 hover:bg-green-700 px-6 py-2 rounded">Test & Save</button>
      </div>
    </form>

    <div id="testResults" class="mt-6 p-4 bg-gray-800 rounded text-sm whitespace-pre-wrap text-green-300 hidden"></div>
  </div>

  <script>
    async function runTestsAndSave() {
      const clientID = document.getElementById("clientID").value.trim();
      const githubToken = document.getElementById("githubToken").value.trim();
      const openaiKey = document.getElementById("openaiKey").value.trim();
      let results = "";

      if (!clientID || !githubToken || !openaiKey) {
        alert("Please fill in all fields.");
        return;
      }

      localStorage.setItem("clientID", clientID);
      localStorage.setItem("githubToken", githubToken);
      localStorage.setItem("openaiKey", openaiKey);

      try {
        const ghRes = await fetch("https://api.github.com/user", {
          headers: { Authorization: `token ${githubToken}` }
        });
        const ghData = await ghRes.json();
        results += ghRes.ok ? `‚úÖ GitHub Token Valid (Hello, ${ghData.login})\n` : `‚ùå GitHub Error: ${ghData.message}\n`;
      } catch (err) {
        results += `‚ùå GitHub Token Check Failed\n`;
      }

      try {
        const aiRes = await fetch("https://api.openai.com/v1/models", {
          headers: { Authorization: `Bearer ${openaiKey}` }
        });
        const aiData = await aiRes.json();
        results += aiRes.ok ? `‚úÖ OpenAI Key Valid (Models available: ${aiData.data.length})\n` : `‚ùå OpenAI Error: ${aiData.error.message}\n`;
      } catch (err) {
        results += `‚ùå OpenAI Key Check Failed\n`;
      }

      document.getElementById("testResults").classList.remove("hidden");
      document.getElementById("testResults").innerText = results;
    }
  </script>
</body>
</html>
